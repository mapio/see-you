CFLAGS = -Wall -pedantic -ansi
CC = gcc

OUTPUTS = $(INPUTS:input-%.txt=output-%.txt)
EXERCISES = $(wildcard ./esercizio-*/.)

.PHONY: outs clean revals rclean $(EXERCISES)

outs: $(OUTPUTS) ;

clean: pulisci
	@rm -f output-*.txt eval.txt

.PRECIOUS: output-%.txt

output-%.txt: input-%.txt args-%.txt $(TARGET)
	./$(TARGET) $$(cat args-$*.txt) < $< > $@

eval.txt: $(DIFFS)
	wc -l $(DIFFS) > eval.txt

revals: $(EXERCISES) ;

$(EXERCISES):
	$(MAKE) -C $@ eval.txt

rclean:
	for e in $(EXERCISES); do $(MAKE) -C $$e clean; done
