CFLAGS = -Wall -pedantic -ansi
CC = gcc

OUTPUTS = $(INPUTS:input-%.txt=diffs-%.txt)
EXERCISES = $(wildcard bundle/esercizio-*/.)

.PHONY: clean tclean outs evals $(EXERCISES)

evals: $(EXERCISES) ;

$(EXERCISES):
	$(MAKE) -C $@ eval.txt

clean:
	for e in $(EXERCISES); do $(MAKE) -C $$e tclean; done

tclean: pulisci
	@rm -f output-*.txt eval.txt

outs: $(OUTPUTS) ;

.PRECIOUS: output-%.txt

output-%.txt: input-%.txt args-%.txt $(TARGET)
	./$(TARGET) $$(cat args-$*.txt) < $< > $@

eval.txt: $(DIFFS)
	wc -l $(DIFFS) > eval.txt
